\chapter{Теория меры}

\section{Системы множеств}

\begin{definition}
    \textit{Полукольцом подмножеств} множества $X$ называют $\cP \subseteq 2^X$,
    удовлетворяющее условиям
    \begin{itemize}
        \item[1.] $\varnothing \in \cP$.
        \item[2.] $A, B \in \cP \Lra A \cap B \in \cP$.
        \item[3.] $\displaystyle \forall A, B \in \cP~ \exists B_1, \ldots,
        B_k \in \cP\colon~ A \setminus B = \bigsqcup_{i = 1}^{k}{B_i}$.
    \end{itemize}
\end{definition}

\begin{definition}
    \textit{Ячейкой} в $\Rm$ называется множество вида
\[
    [\ea, \eb) = \{\, \x \in \Rm \mid \ea_i \leqslant \x_i < \eb_i \,\}
\]
\end{definition}

\begin{theorem}(Свойства полуколец)
    \begin{itemize}
        \item[1.] $A \in \cP \nRightarrow \bar{A} \in \cP$
        \item[2.] $A, A' \in \cP \nRightarrow A~@~A' \in \cP$, $@ \in
        \{\, \cup, \setminus, \triangle \,\}$
        \item[3.] $\displaystyle A_1, \ldots, A_n \in \cP \Lra A \setminus
        \left(\bigcup_{i = 1}^{n}{A_i}\right) = \bigsqcup_{fin}{D_j}$
    \end{itemize}
\end{theorem}

\begin{definition}
    \textit{Алгеброй подмножеств} множества $X$ называется множество $\cA \in
    2^X$ такое, что выполнены аксиомы:
    \begin{itemize}
        \item[1.] $X \in \cA$
        \item[2.] $A, B \in \cA \Lra A \setminus B \in \cA$
    \end{itemize}
\end{definition}

\begin{theorem}(Свойства алгебр)
    \begin{itemize}
        \item[1.] $\varnothing = X \setminus X \in \cA$
        \item[2.] $A \cap B = A \setminus (A \setminus B) \in \cA$
        \item[3.] $\overline{A} = X \setminus A \in \cA$
        \item[4.] $A \cup B \in \cA$
\[
        X \setminus (A \cup B) = (X \setminus A) \cap (X \setminus B)
\]
        \item[5.] $\displaystyle A_1, \ldots A_n \in \cA \Lra \bigcup_{i = 1}^{n}{A_i} \in
        \cA$, $\displaystyle \bigcap_{i = 1}^{n}{A_i} \in \cA$
        \item[6.] Алгебра подмножеств является полукольцом подмножеств
    \end{itemize}
\end{theorem}

\begin{definition}
    \textit{$\sigma$-Алгеброй подмножеств} множества $X$ называется алгебра
    подмножеств $\cA$, удовлетворяющая дополнительной аксиоме: \\
    $\displaystyle \{\,A_n\,\} \in \cA \Lra \bigcup_{n = 1}^{+\infty}{A_n} \in \cA$.
\end{definition}

\begin{lemma}(О нарезке)

    Пусть $A_0, A_1, \ldots, A_n \subseteq X$. Тогда набор множеств
\[
    B_1 = A_1,~ B_2 = A_2 \setminus A_1, \ldots, B_k = A_k \setminus
        \left (\bigcup_{i = 1}^{k - 1}{A_i} \right), \ldots
\]
    дизъюнктен, причем
\[
    \bigsqcup_{i = 1}^{n}{B_i} = \bigcup_{i = 1}^{n}{A_i}
\]
\end{lemma}

\begin{lemma}(О минимальной алгебре)

    Пусть $\cP$ --- полукольцо. Положим $\cA_0$ --- система подмножеств,
    состоящая из всевозможных конечных объединений множеств из $\cP$, а так
    же из их дополнений. Тогда
    \begin{itemize}
        \item $\cA_0$ --- алгебра подмножеств.
        \item Для любой алгебры $\cA \supseteq \cP$ верно, что $\cA \supseteq \cA_0$
    \end{itemize}
\end{lemma}

\section{Объём}

\begin{definition}
    Пусть $\cP$ --- полукольцо, $\mu \colon \cP \to \Rbar$ называется
    \textit{конечно-аддитивной}, если
    \begin{itemize}
        \item[1.] $\mu$ принимает не более одного значения из $\{\,+\infty, -\infty\,\}$
        \item[2.] $\mu(\varnothing) = 0$
        \item[3.] $A_1, \ldots, A_n \in \cP$, $A_i \cap A_{j \neq i} = \varnothing$,
        тогда если оказалось, что $\displaystyle A = \bigsqcup_{i = 1}^{n}{A_i} \in \cP$,
        то \\ $\displaystyle \mu(A) = \sum_{i = 1}^{n}{\mu(A_i)}$
    \end{itemize}
\end{definition}

\begin{definition}
    Пусть $\mu \colon \cP \to \Rbar$ называется \textit{объёмом}, если
    \begin{itemize}
        \item[1.] $\mu$ конечно-аддитивна
        \item[2.] $\mu \geqslant 0$
    \end{itemize}
\end{definition}

\begin{definition}
    Объём называется \textit{конечным}, если $\mu(X) < +\infty$.
\end{definition}

\begin{definition}
    \textit{Классическим объёмом} в $\Rm$ называется объём, заданный на
    полукольце ячеек в $\Rm$, вычисляющийся по формуле
    $\displaystyle \mu([\ea, \eb)) = \prod_{k = 1}^{m}{(\eb_k - \ea_k)}$.
\end{definition}

\begin{lemma}(Монотонность объёма)

    Для объёма $\mu,$ $A, B \in \cP$, $A \subseteq B$ выполено $\mu(A) \leqslant \mu(B)$.
\end{lemma}
\begin{proof}
\[
    B = A + B \setminus A = A + \bigsqcup{D_i} \Lra \mu(B) = \mu(A) + \sum{\mu(D_i)}
    \geqslant \mu(A)
\]
\end{proof}

\begin{theorem}(Свойства объёма)
    \begin{itemize}
        \item[1.] $\displaystyle \forall A, \text{ дизъюнктных } A_1 \ldots, A_n \in \cP
        \colon~ \bigsqcup_{i = 1}^{n}{A_i} \subseteq A \Lra
        \sum_{i = 1}^{n}{\mu(A_i)} \leqslant \mu(A)$ \\ (усиленная монотонность)
        \item[2.] $\displaystyle \forall A, A_1 \ldots, A_n \in \cP
        \colon~ A \subseteq \bigcup_{i = 1}^{n}{A_i} \Lra
        \mu(A) \leqslant \sum_{i = 1}^{n}{\mu(A_i)}$ \\ (конечная полуаддитивность)
        \item[3.] $A, B, A \setminus B \in \cP \Lra \mu(A \setminus B) \geqslant
                \mu(A) - \mu(B)$
    \end{itemize}
\end{theorem}
\begin{proof}
    \enewline
    \begin{itemize}
        \item[1.]
\begin{align*}
    &A \setminus \bigsqcup_{i = 1}^{n}{A_i} = \bigsqcup_{i = 1}^{k}{D_i} \Lra A
    = \left(\bigsqcup_{i = 1}^{n}{A_i}\right) \sqcup \left(\bigsqcup_{i = 1}^{k}{D_i}\right) \\
    &\Lra \mu(A) = \sum_{i = 1}^{n}{\mu(A_i)}) + \sum_{i = 1}^{k}{\mu(D_i)} \geqslant
    \sum_{i = 1}^{n}{\mu(A_i)}
\end{align*}
        \item[2.] Сейчас будет использован стандартный прием, смысл которого заключается в
                переходе от простого объединения к дизъюнктному. Пусть $B_k = A \cap A_k$.
                Тогда $A = \bigcup{B_k}$. Теперь \textit{нарежем $B_k$}:
\[
    C_k = B_k \setminus \bigcup_{i = 1}^{k - 1}{B_i}
\]
    При $k > 1$ и $C_1 = B_1$. Набор $C_k$ получился дизъюнктным:
\[
    A = \bigsqcup_{i = 1}^{n}{C_i}
\]
	Сами множетсва $C_k$ могут и не быть в $\cP$, но $B_k \in \cP$ как пересечения
	множеств из $\cP$. Из определения $C_k$ имеем, что,
\[
	C_k = \bigsqcup_{i = 1}^{j_k}{D_{ki}}
\]
	Тогда можно вычислить объём $A$:
\[
	\mu(A) = \sum_{k, i}{\mu(D_{ki})}
\]
	Теперь воспользуемся монотонностью объёма: $C_k \subseteq B_k \subseteq A_k$:
\[
	\sum_{j}{D_{kj}} \leqslant \mu(B_k) \leqslant \mu(A_k)
\]
	Поэтому
\[
	\mu(A) = \sum_{k}{\sum_{j}{D_{kj}}} \leqslant \sum_{k}{\mu(A_k)}
\]
		\item[3.]
				\enewline
				\begin{itemize}
					\item[(a)]
\[
	B \subseteq A \Lra \mu(A) = \mu(A \setminus B) + \mu(B) \Lra \mu(A \setminus B)
	= \mu(A) - \mu(B)
\]
					\item[(b)]
\[
	A \setminus B = A \setminus (A \cap B) \Lra \mu(A \setminus B) = \mu(A) - \mu(A \cap B)
	\geqslant \mu(A) - \mu(B)
\]
				\end{itemize}
    \end{itemize}
\end{proof}

\section{Мера}

\begin{definition}
    \textit{Мерой} называется объём $\mu \colon \cP \to \Rbar$, обладающий свойством
    счётной аддитивности.
\end{definition}

\begin{theorem}
    Пусть $\mu \colon \cP \to \Rbar$ --- объём. Тогда эквивалентны утверждения:
    \begin{itemize}
        \item[1.] $\mu$ счетно-аддитивен
        \item[2.] $\mu$ счетно-полуаддитивен
    \end{itemize}
\end{theorem}
\begin{proof}
	Импликация $1 \Lra 2$ доказывается практически так же, как второй
	пункт предыдущей теоремы (используется нарезка). Докажем $2 \Lra 1$.
	Для этого воспользуемся усиленной монотонностью объёма ($A_i$ дизъюнктны):
\[
	\forall N~ \sum_{i = 1}^{N}{\mu(A_i)} \leqslant \mu(A)
\]
	Добавляя к этому посылку:
\[
	\forall N~ \sum_{i = 1}^{N}{\mu(A_i)} \leqslant \mu(A) \leqslant
	\sum_{i = 1}^{+\infty}{\mu(A_i)}
\]
	И переходя к пределу при $N \to +\infty$, получаем требуемое.
\end{proof}

\begin{theorem}
    Пусть $\cA$ --- алгебра, $\mu \colon \cA \to \Rbar$ --- объём. Тогда
    эквивалентны утверждения:
    \begin{itemize}
        \item[1.] $\mu$ счетно-аддитивно
        \item[2.] $\mu$ \textit{непрерывно снизу}, то есть
        $\displaystyle A,~A_1, A_2 \ldots~ \in \cA\colon A_1 \subset A_2 \subset \ldots$;
        $\displaystyle A = \bigcup_{i = 1}^{+\infty}{A_i} \Lra \\ \mu(A) = \lim_{n \to
        +\infty}{\mu(A_i)}$
    \end{itemize}
\end{theorem}
\begin{proof}
	\enewline
	\begin{itemize}
		\item [$1 \Lra 2$] Нарежем множетсва:
\[
	B_1 = A_1, \ldots, B_k = A_k \setminus \left(\bigcup_{i = 1}^{k - 1}{A_i}\right)
\]
	Как всегда, $B_k$ дизъюнктны, причем $A = \bigsqcup_{i = 1}^{+\infty}{B_k}$.
	Тогда, пользуясь счетной аддитивностью, имеем:
\[
	\mu(A) = \sum_{i = 1}^{+\infty}{\mu(B_i)}
	= \lim_{N \to +\infty}{\sum_{i = 1}^{N}{\mu(B_i)}}
	= \lim_{N \to +\infty}{\mu(A_k)}
\]
		\item [$2 \Lra 1$] Пусть есть дизъюнктные $A_k$. Сделаем из них $C_k$:
\[
	C_k = \bigsqcup_{i = 1}^{k}{A_i}
\]
		Тогда $C_1 \subseteq C_2 \subseteq \ldots$. Воспользуемся непрерывностью снизу:
\[
	\mu(A) = \mu(C) = \lim_{N \to +\infty}{\mu(C_k)}
	= \lim_{k \to +\infty}{\sum_{i = 1}^{k}{\mu(A_k)}}
	= \sum_{k = 1}^{+\infty}{\mu(A_k)}
\]
	\end{itemize}
\end{proof}

\begin{theorem}
    Пусть $\cA$ --- алгебра, $\mu \colon \cA \to \Rbar$ --- \textbf{конечный} объём.
    Тогда эквивалентны утверждения:
    \begin{itemize}
        \item[1.] $\mu$ счетно-аддитивен
		\item[2.] $\mu$ \textit{непрерывно сверху}
\[
	A,~A_1, A_2 \ldots~ \in \cA\colon A_1 \supset A_2 \supset \ldots;~
    \displaystyle A = \bigcap_{i = 1}^{+\infty}{A_i} \Lra \\ \mu(A) = \lim_{n \to
    +\infty}{\mu(A_i)}
\]
        \item[3.] $\mu$ \textit{непрерывно сверху на пустом множестве}, то есть
			при условии, что $A = \varnothing$.
    \end{itemize}
\end{theorem}
\begin{proof}
	\enewline
	\begin{itemize}
		\item [$1 \Lra 2$] Будем пользоваться непрерывностью снизу, но для этого
			нужна подготовка:
\[
	B_1 = A_1 \setminus A, \ldots, B_k = A_1 \setminus A_k
\]
	Тогда $B_1 \subseteq B_2 \subseteq \ldots$; $B = \bigcup{B_k}$:
\[
	\mu(A_1) - \mu(A) = \mu(B) = \lim_{k \to +\infty}{\mu(B_k)}
	= \lim_{k \to +\infty}{\mu(A_1)} - \lim_{k \to +\infty}{\mu(A_k)}
\]
	Откуда
\[
	\mu(A) = \lim_{k \to +\infty}{\mu(A_k)}
\]
		\item[$2 \Lra 3$] Очевидно.
		\item[$3 \Lra 1$] Пусть $C_k$ дизъюнктны. Положим
\[
	A_k = \bigsqcup_{i = k+1}^{+\infty}{C_k}
\]
	Тогда $A_1 \supseteq A_2 \supseteq \ldots$; $A = \bigcap{A_k} = \varnothing$.
	Вообще говоря, $A_k \notin \cA$. Но в нашем случае
\[
	A_k = C \setminus \bigsqcup_{i = 1}^{k}{C_i} \in \cA
\]
	Далее надо как-то воспользоваться непрерывностью сверху:
\[
	C = A_k \sqcup \left(\bigsqcup_{i = 1}^{k}{C_k}\right)
	\Lra \mu(C) = \mu(A_k) + \sum_{i = 1}^{k}{\mu(C_k)}
\]
	Переходя к пределу при $k \to +\infty$, получаем требуемое.
	\end{itemize}
\end{proof}

\section{О стандартном продолжении меры}

\begin{definition}
    \textit{Пространством с мерой} называется тройка $\langle X, \cA, \mu \rangle$,
    где $\cA$ --- $\sigma$-алгебра, $\mu \colon \cA \to \Rbar$ --- мера.
\end{definition}

\begin{definition}
    $\langle X, \cA, \mu \rangle$ называется \textit{полным} (соответственно мера
    называется \textit{полной}), если $\forall E \in \cA \colon~ \mu(E) = 0 \Lra
    \forall A \subseteq E~ A \in \cA$ и $\mu(A) = 0$.
\end{definition}

\begin{definition}
    $\langle X, \cP, \mu \rangle$ называется \textit{$\sigma$-конечным} (соответственно
    мера называется \textit{$\sigma$-конечной}), если $\displaystyle
    X = \bigcup_{i = 1}^{+\infty}{B_k}$, где $\mu(B_k) < +\infty$.
\end{definition}

\begin{theorem}(О стандартном продолжении меры)

    $\langle X, \cP, \mu_0 \rangle$, $\mu_0$ --- $\sigma$-конечный объём. Тогда
    $\exists~ \sigma$-алгебра $\cA$ и мера $\mu \colon \cA \to \Rbar\colon$
    \begin{itemize}
        \item[1.] $\cP \subseteq \cA$, $\mu\big|_{\cP} = \mu_0$
        \item[2.] $\mu$ полная
        \item[3.] Если $\cA' \supseteq \cP$, $\mu'\big|_{\cP} = \mu_0$,
        $\mu'$ --- полная, тогда $\cA \subseteq \cA'$ и $\mu'\big|_{\cA} = \mu$
        \item[4.] Если $\cP'$ --- полукольцо, $\mu'$ --- мера на $\cP'$,
        $\cP \subseteq \cP' \subseteq \cA$, тогда $\mu' = \mu\big|_{\cP'}$
        \item[5.] $\displaystyle \forall A \in \cA~ \mu(A) =
        \inf{\left(\sum_{k = 1}^{+\infty}{\mu_0(P_k)} ~\bigg|~ A \subseteq \bigcup_{k = 1}
        ^{+\infty}{P_k}, P_k \in \cP\right)}$
    \end{itemize}
\end{theorem}

\section{Мера Лебега}

\begin{theorem}
    Классический объём в $\Rm$ является $\sigma$-конечной мерой.
\end{theorem}
\begin{proof}
	$\s$-конечность очевидна. Докажем счетную полуаддитивность. Пусть
	$[a, b) \subseteq \bigcup_{n = 1}^{+\infty}{[a_n, b_n)}$. Наша цель ---
	показать, что $\mu[a, b) \leqslant \sum_{n = 1}^{+\infty}{\mu[a_n, b_n)}$.
	Выберем $b' < b$ таким образом, чтобы
\[
	\mu[a, b) - \e < \mu[a, b') < \mu[a, b)
\]
	И $a_n' < a_n$ так, чтобы
\[
	\forall n~ \mu[a_n, b_n) < \mu[a_n', b_n) < \mu[a_n, b_n) + \frac{\e}{2^n}
\]
	Теперь отрезок $[a, b']$ накрыт счетным объедиением интервалов $(a'_n, b_n)$.
	Выберем из этого покрытия конечное:
\[
	[a, b'] \subseteq \bigcup_{n = 1}^{N}{(a'_n, b_n)} \subseteq
	\bigcup_{n = 1}^{N}{[a'_n, b_n)}
\]
	Воспользуемся конечной полуаддитивностью:
\[
	\mu[a, b') \leqslant \sum_{n = 1}^{N}{\mu[a'_n, b_n)} \leqslant
	\sum_{n = 1}^{N}{\left(\mu[a_n, b_n) + \frac{\e}{2^n}\right)} \leqslant
	\sum_{n = 1}^{N}{\mu[a_n, b_n)} + \e
\]
	С другой стороны:
\[
	\mu[a, b) - \e < \mu[a, b') \leqslant \sum_{n = 1}^{N}{\mu[a_n, b_n)} + \e
\]
	Откуда и следует требуемое.
\end{proof}

\begin{definition}
    \textit{Мерой Лебега} называется стандартное продолжение классического объёма.
\end{definition}

\begin{definition}
    Алгебра, на которой определена мера Лебега, обозначается $\mathfrak{M}$.
\end{definition}

\begin{definition}
    \textit{Измеримыми по Лебегу} называются множества $A \in \mathfrak{M}$.
\end{definition}

\begin{theorem}(Свойства меры Лебега)
    \begin{itemize}
        \item[1.] Объединения и пересечения измеримых множеств измеримы.
        \item[2.] Все открытые и замкнутые множества измеримы.
    \end{itemize}
\end{theorem}

\begin{lemma}(О структуре открытых множеств)
    \begin{itemize}
        \item[1.] $\Od \subseteq \Rm$ открыто $\Lra~ \exists Q_i$ --- ячейки в $\Rm$
        такие, что $\displaystyle \Od = \bigsqcup_{i}{Q_i}$, причем можно
        дополнительно считать, что выполнено что-либо из нижеперечисленного:
        \begin{itemize}
            \item[(a)] Ячейки имеют рациональные (двоично-рациональные) координаты
            \item[(b)] $\Cl(Q_i) \subseteq \Od$
            \item[(c)] $Q_i$ --- кубы
        \end{itemize}
        \item[2.] Пусть $E$ измеримо в $\Rm$, $\lambda(E) = 0$, тогда
        $\forall \e > 0~\exists Q_i$ --- ячейки в $\Rm$ такие, что
\[
		E \subseteq \bigcup_{i}{Q_i} \text{ и }
		\sum_{i}{\mu(Q_i)} < \e
\]
		причем можно потребовать свойства $(a) - (c)$ и дизъюнктность набора ячеек.
    \end{itemize}
\end{lemma}
\begin{proof}
	\enewline
	\begin{itemize}
		\item[1.] Всем точкам $\cO$ сопоставим ячейку требуемого типа с рациональными
			параметрами. Таких ячеек не более чем счетное множество:
\[
	\cO = \bigcup_{i = 1}^{+\infty}{\widetilde{Q}_i}
\]
		Теперь надо сделать эти ячейки дизъюнктыми. Для этого воспользуемся тем,
		что их счетное число:
\[
	Q'_1 = \widetilde{Q}_1, \ldots, Q'_k = \widetilde{Q}_k \setminus \bigcup_{i = 1}^{k - 1}
	{\widetilde{Q}_i}
\]
	$\forall i~ Q'_i$ выражается через дизъюнктное объединение ячеек нужного типа,
	так как полукольцо ячеек --- полукольцо. Тогда:
\[
	\cO = \bigcup_{i = 1}^{+\infty}{\widetilde{Q}_i}
	= \bigsqcup_{i = 1}^{+\infty}{Q'_i}
	= \bigsqcup_{i = 1}^{+\infty}{\bigsqcup_{j = 1}^{k_i}{D_{ij}}}
\]
		\item[2.] Пятый пункт теоремы о продолжении поставляет нам способ получить
			ячейки, удовлетворяющие всему, кроме дизъюнктности и $(a) - (c)$. Эти
			свойства придется добывать самостоятельно. Пусть множества $\widetilde{P}_i$
			пришли из теоремы для $\e = \frac{\e}{2}$:
\[
	\sum{\l(\widetilde{P}_i)} < \frac{\e}{2}
\]
	Немного расширим эти множества до открытых $P_i \supset \widetilde{P}_i$. Эти множества
	по первому пункту текущей леммы представляются в виде нужного нам объединения:
\[
	P_i = \bigsqcup{D_{ij}}
\]
	Потребуем (при выборе $P_i$):
\[
	\l(\widetilde{P}_i) < \l(P_i) < \l(\widetilde{P}_i) + \frac{\e}{2^i}
\]
	Тогда получается то, что нужно:
\[
	\sum{\l(D_{ij})} = \sum{\l(P_i)} < \sum{\left(\l(\widetilde{P}_i) + \frac{\e}{2^i}\right)}
	\leqslant \e
\]
	\end{itemize}
\end{proof}

\begin{theorem}(Свойства меры Лебега)
    \begin{itemize}
        \item[3.] Пример: канторово множество в $\R$. Строится итеративно:
\begin{align*}
	\mathfrak{K}_0 &= \left[0, 1\right] \\
	\mathfrak{K}_1 &= \left[0, \frac{1}{3}\right] \cup \left[\frac{2}{3}, 1\right]\\
	\mathfrak{K}_2 &= \left[0, \frac{1}{9}\right] \cup \left[\frac{2}{9}, \frac{3}{9}\right]
		\cup \left[\frac{6}{9}, \frac{7}{9}\right] \cup \left[\frac{8}{9}, 1\right]
			   \\	&\cdots \\
	\mathfrak{K} &= \bigcap_{i = 0}^{+\infty}{\mathfrak{K}_i}
\end{align*}
		Получившееся множество измеримо, потому что является пересечением измеримых
		множеств. Его мера равна нулю, потому что к нулю стремится мера
		$\mathfrak{K}_i$. С другой стороны, можно задать это же множество в другом виде:
\[
	\mathfrak{K} = \{\, 0.\e_1\e_2\ldots_3  \mid \e_i \in \{\,0,2\,\}  \,\}
\]
		По построению понятно, что из отрезка просто выкинули все точки, троичная запись
		которых содержит хотя бы одну единицу. Тогда $\mathfrak{K}$ континуально
		как множество бинарных последовательностей.
        \item[4.] Пример: неизмеримое множество. Совершенно очевидно, что одними
			только пересечениями и объединениями не получится построить неизмеримое множество.
			Привлечем к борьбе с измеримостью фактормножества. Пусть $\sim$ --- отношение,
			заданное на отрезке $[0, 1]$ такое, что:
\[
	a \sim b \Llra a - b \in \bQ
\]
		Рассмотрим тогда фактормножество $A = [0, 1] ~/ \sim$. Предположим, что оно
		измеримо. В одной из следующих теорем будет доказано, что мера Лебега инвариантна
		относительно сдвига, то есть $\l(A) = \l(A + q)$. Пусть тогда
\[
	B = \bigsqcup_{q \in [-1, 1] \cap \bQ}{\left(A + q\right)}
\]
		Дизъюнктность объединяемых множеств очевидна. Тогда $B$ тоже измеримо, причем
\[
	B \subseteq [-1, 2], B \supseteq [0, 1] \Lra 0 < \l(B) < +\infty
\]
		Но с другой стороны можно вычислить $\l(B)$ через $\l(A)$:
\[
	\l(B) = \sum_{q \in [-1, 1] \cap \bQ}{\l(A + q)} = \begin{cases}
		0,~ \l(A) = 0 \\
		+\infty,~ \l(A) > 0
	\end{cases}
\]
		Возникло противоречие, поэтому $A$ неизмеримо.
	    \item[5.] \begin{itemize}
                    \item $A$ ограничено, тогда $\lambda(A) < +\infty$
                    \item $A$ открыто, тогда $\lambda(A) > 0$
                    \item $\lambda(A) = 0 \Lra$ У $A$ нет внутренних точек
                  \end{itemize}
        \item[6.] $A$ измеримо, тогда $\forall \e > 0$
                \begin{itemize}
                    \item $\exists G_{\e}$ открытое такое, что
                    $A \subset G_{\e}$, $\lambda(G_{\e} \setminus A) < \e$
                    \item $\exists F_{\e}$ замкнутое такое, что
                    $F_{\e} \subset A$, $\lambda(A \setminus F_{\e}) < \e$
                \end{itemize}
    \end{itemize}
\end{theorem}
\begin{proof}
	\enewline
	\begin{itemize}
		\item[5.] Очевидно.
		\item[6.] \begin{itemize}
			\item
			\begin{itemize}
				\item[(i)] Пусть $\l(A) < +\infty$. Из последнего пункта теоремы о
					продолжении получаем набор $P_i$ такой, что
\[
	\l(A) < \sum{\l(P_i)} < \l(A) + \e 
\]
			Далее немного расширим $P_i$ до открытого $\widetilde{P}_i$, которое
			наполовину замкнем до ячейки $\widetilde{\widetilde{P}}_i$:
\[
	P_i \subset \widetilde{P}_i \subset \widetilde{\widetilde{P}}_i \in \cP
\]
			Расширим мы несильно, а именно:
\[
	\l\left(\widetilde{\widetilde{P}}_i\right) - \l(P_i) < \frac{\e}{2^i}
\]
			В таком случае положим
\[
	G_{2\e} = \bigcup{\widetilde{P}_i}
\]
     		и проверим, что оно подходит:
\[
	\l(A) < \l(G_{2\e}) \leqslant \sum{\l\left(\widetilde{\widetilde{P}}_i\right)}
	\leqslant \l(A) + 2\e
\]
	$A \subset G_{2\e}$, поэтому:
\[
	\l(G_{2\e} \setminus A) = \l(G_{2\e}) - \l(A) < 2\e
\]
				\item[(ii)] $\l(A) = +\infty$. Воспользуемся $\s$-конечностью $\Rm$:
\[
	\Rm = \bigsqcup{Q_i} \Lra A = \bigsqcup{A \cap Q_i}
\]
			Пользуясь (i), расширим $A \cap Q_i$ до открытого множества $(G_{\e})_i$
			так, чтобы
\[
	\l((G_\e)_i \setminus (A \cap Q_i)) < \frac{\e}{2^i}
\]
			Пусть тогда $G_\e = \bigcup{(G_\e)_i}$. Проверим, что оно подходит:
\[
	\l(A) <	\l(G_\e) \leqslant \sum{\l((G_\e)_i)} < \sum{\l(A \cap Q_i)} + \e = \l(A) + \e
\]
			\end{itemize}
			\item Переход к дополнению: $A^c$ открыто, поэтому
\[
		\exists G_\e\colon~	\l(G_\e \setminus A^c) < \e \Lra \l(A \setminus G_\e^c)
		= \l(G_\e \setminus A^c) < \e
\]
		То есть $F_\e = G_\e^c$ подходит.
		\end{itemize}
	\end{itemize}
\end{proof}

\begin{definition}
    Пусть $\cA \subseteq 2^X$, тогда \textit{борелевской оболочкой} множества $\cA$
    называют минимальную по включению $\sigma$-алгебру, содержащую $\cA$.
\end{definition}

\begin{definition}
    \textit{Борелевской $\sigma$-алгеброй} называется борелевская оболочка
    всех открытых множеств.
\end{definition}

\begin{corollary}
    $A$ измеримо, тогда $\exists$ борелевские $B, C\colon$ $B \subset A \subset C$
    такие, что $\lambda(C \setminus B) = 0$.
\end{corollary}
\begin{proof}
	Возьмем в качестве $B = \bigcup{F_{\frac{1}{n}}}$, $C = \bigcap{G_{\frac{1}{n}}}$.
	Имеем
\[
	F_{\frac{1}{n}} \subseteq A \subseteq G_{\frac{1}{n}}
\]
	И
\[
	\forall n~ \l(B \setminus A) < \l(G_{\frac{1}{n}} \setminus F_{\frac{1}{n}}) < \frac{2}{n}
\]
	Поэтому $\l(B \setminus A) = 0$. $B$, $A$ борелевские, потому что являются пересечением 
	и объединеием борелевских множеств.
\end{proof}

\begin{corollary}
    $A$ измеримо, тогда $A = B \cup \mathfrak{N}$, $B$ --- борелевское,
    $\lambda(\mathfrak{N}) = 0$.
\end{corollary}
\begin{proof}
	Возьмем в качестве $B$ множество $B$ из предыдущего следствия, а в качестве 
	$\mathfrak{N}$ --- множество $A \setminus B$. Тогда $\l(\mathfrak{N}) \leqslant
	\l(C \setminus B) = 0$.
\end{proof}

\begin{corollary}(Регулярность меры Лебега)

    Пусть $A$ измеримо, тогда
\[
    \lambda(A) = \inf_{\substack{G \supset A \\ G \text{ открыто}}}{\lambda(G)}
    = \sup_{\substack{F \subset A \\ F \text{ замкнуто}}}{\lambda(F)}
    = \sup_{\substack{K \subset A \\ K \text{ компакт}}}{\lambda(K)}
\]
\end{corollary}
\begin{proof}
	Первые два пункта следуют из существования последовательностей открытых 
	$G_{\frac{1}{n}}$ и замкнутых $F_{\frac{1}{n}}$, которые и дают нужный 
	супремум или инфимум. Докажем последнее равенство.
	\begin{itemize}
		\item Пусть $A$ ограничено. Тогда 
\[
	\sup_{\substack{F \subset A \\ F \text{ замкнуто}}}{\lambda(F)} 
	= \sup_{\substack{K \subset A \\ K \text{ компакт}}}{\lambda(K)}
\]
	Левая часть равенства отличается от правой только тем, 
	что там разрешены неограниченные множества; но неограниченных подмножеств 
	ограниченного множества не бывает, поэтому получаем равенство.
		\item Пусть теперь $A$ неограничено.
			\begin{itemize}
				\item $\l(A) < +\infty$. Воспользуемся непрерывностью снизу:
\begin{align*}
	\Rm &= \bigcup{B(0, n)};~ A_n = A \cap B(0, n) \Lra A_1 \subset A_2 \subset \ldots\\
		&  \Lra \lim{\l(A_n)} = \l(A)
\end{align*}
				Начиная с некоторого места, $\l(A_n) > \l(A) - \e$, при этом, $A_n$ 
				ограничены. Выберем тот компакт (он есть по первому пункту), для которого \\
				$\l(K) > \l(A_n) - \e$. Тогда, поскольку $K \subset A_n \subset A$,
				имеем, что 
\[
		\l(A \setminus K) = \l((A \setminus A_n) \cup (A_n \setminus K)) < 2\e
\]
		\item $\l(A) = +\infty$. Доказывается аналогично, просто определение предела поменяется.
			Общий итог доказательства будет выглядеть так:
\[
	\forall R~ \exists A_n \colon~ \l(A_n) > R + 1~ \exists K \subset A_n\colon~ \l(K) > R
\]
			\end{itemize}
	\end{itemize}
\end{proof}

\begin{lemma}

    Пусть $\langle X', \cA', \mu' \rangle$ --- пространство с мерой.
    $\langle X, \cA, \_ \rangle$ --- заготовка для пространства с мерой.
    $T \colon X \to X'$ --- биекция, $\forall A \in \cA~ T(A) \in \cA'$,
    Положим $\mu(A) = \mu'(T(A))$. Тогда
    $\mu$ --- мера на $\cA$.
\end{lemma}
\begin{proof}
	Докажем счетную аддитивность. Пусть $A = \bigsqcup{A_i}$. Тогда:
\[
	\mu(A) = \mu'(T(A)) = \mu'\left(T\left(\bigsqcup{A_i}\right)\right) 
	= \mu'\left(\bigsqcup{T(A_i)}\right) 
	= \sum{\mu'(T(A_i))} = \sum{\mu(A_i)}
\]
	Переход от образа объединения к объединению образов можно совершить из-за 
	того, что $T$ --- биекция.
\end{proof}

\begin{lemma}
	Пусть $A$ --- измеримое по Лебегу множество. Тогда $A$ представимо в виде 
\[
	A = \bigcup{K_i} \cup \mathfrak{N}
\]
	Где $K_i$ компакты и $\l(\mathfrak{N}) = 0$.
\end{lemma}
\begin{proof}
	Доказательство аналогично доказательству пункта (6) теоремы о свойствах меры Лебега 
	за исключением того, что пересечь или объединить компакты не получится.
\end{proof}

\begin{lemma}
    $T \colon \Rm \to \Rn \in C(\Rm)$, $\forall E \in \mathfrak{M}~ \lambda(E) = 0
    \Lra \lambda(T(E)) = 0$, \\ тогда $\forall A \in \mathfrak{M}~ T(A) \in \mathfrak{M}$.
\end{lemma}
\begin{proof}
	Пользуясь леммой, представим $A$ в виде:
\[
	A = \bigcup{K_i} \cup \mathfrak{N}
\]
	Тогда
\[
	T(A) = \bigcup{T(K_i)} \cup T(\mathfrak{N})
\]
	$T(K_i)$ --- непрерывный образ компакта, то есть компакт, а значит, борелевское множество,
	$T(\mathfrak{N})$ измеримо по условию, поэтому $T(A)$ измеримо как объединение измеримых 
	множеств.
\end{proof}

\begin{example}(Канторова лестница)
	Это --- пример, показывающий, что для того, чтобы отображение сохраняло 
	измеримость, непрерывности мало. Зададим $f$ итеративно: на отрезке 
	$[\frac{1}{3}, \frac{2}{3}]$ положим $f(x) = \frac{1}{2}$. Будем
	повторять такой процесс рекурсивно в левой и правой трети отрезка $[0, 1]$, 
	задавая на среднем отрезке значения, равные среднему арифметическому значений
	на соседних отрезках. Доопределим 
	$f$ на $[0, 1]$ так, чтобы $f$ оказалась непрерывна (кстати, подобное продолжение
	единственно):
\[
	f(x) = \sup\left(f\left(\frac{m}{3^k}\right) ~\bigg|~ \frac{m}{3^k} \leqslant x\right)
\]
	Заметим, что $f(\mathfrak{K}) = [0, 1]$, где $\mathfrak{K}$ --- канторово множество.
	То есть, мы отобразили множество нулевой меры на целый отрезок.
	Возьмем теперь совершенно любое неизмеримое подмножество $A \subset [0, 1]$ 
	(см. пример ранее). Поскольку $f(\mathfrak{K}) = [0, 1]$, существует множество 
	$e \subseteq \mathfrak{K}$ такое, что $f(e) = A$, причем $e$ измеримо по полноте
	меры Лебега. Получается, что мы отобразили измеримое множество на неизмеримое.
\end{example}

\begin{theorem}
	Пусть $\cO \subseteq \Rm$ --- открыто, $\f \colon \cO \to \Rm$ --- гладкое. Тогда
	$\f$ сохраняет измеримость.
\end{theorem}
\begin{proof}
	Достаточто проверить, что $\f$ переводит множества нулевой меры в множества 
	нулевой меры. Пусть $\cO = \bigsqcup{Q_i}$, причем $\Cl(Q_i) \subseteq \cO$
	(лемма о структуре открытых множеств, п.1). Теперь из соображений счетной аддитивности 
	достаточно проверить утверждение для подмножеств $Q_i$. По теореме Лагранжа:
\[
	\forall \ex, \ey \in Q_i~ \norm{\f(\ex) - \f(\ey)} \leqslant L \norm{\ex - \ey}
\]
	Где $L = \sup_{x \in \Cl(Q_i)}{\norm{\f'(\ex)}} < +\infty$, потому что $\f$ гладкое.
	Далее мы накроем наше множество нулевой меры $E$ маленькими кубами (лемма 
	о структуре открытых множеств, п.2), 
	которые после пересадки дадут маленькие шары:
\[
	\forall \e > 0~ \exists D_i = D(\ex_i, r_i) \text{ --- кубы}\colon~ 
	E \subseteq \bigcup{D_i},~ \sum{\l(D_i)} < \e
\]
	Тогда посмотрим, насколько большим может оказаться образ $E$:
\[
	\f(E) \subseteq \bigcup{\f(D_i)} \subseteq 
	\bigcup{B(\f(\ex_i), \sqrt{m} \cdot L \cdot r_i)} \subseteq
	\bigcup{K(\f(\ex_i), \sqrt{m} \cdot L \cdot r_i)}
\]
	Оценим меру получившегося образа:
\[
	\l(\f(E)) \leqslant \sum{\l(K_i)} = \sum{(2 \sqrt{m} \cdot L \cdot r_i)^m}
	= (\sqrt{m} \cdot L)^m \cdot \sum{\l(D_i)} < (\sqrt{m} \cdot L)^m \cdot \e
\]
\end{proof}

\begin{corollary}
	Мера Лебега инвариантна относительно сдвига.
\end{corollary}
\begin{proof}
	Сдвиг как отображение гладкий, поэтому измеримость сохраняется. Из теоремы
	о продолжении меры мы знаем, что мера Лебера вычисляется на основе мер
	ячеек. При сдвиге, очевидно, мера ячеек не изменяется, поэтому не изменяется и мера 
	других множеств.
\end{proof}

\begin{theorem}(О других мерах)
	Пусть $\mu$ --- мера на $\mathfrak{M}$, инвариантная относительно сдвига и конечная на 
	ограниченных множествах. Тогда $\exists K \in [0, +\infty)\colon~ \mu = K \cdot \l$.
\end{theorem}

\begin{definition}
	Линейное отображение пространства $\Rm$, сохраняющее скалярное произведение, 
	называется \textit{ортогональным}.
\end{definition}

\begin{theorem}
	Линейное отображение конечномерных евклидовых пространств $f \colon X \to Y$ 
	сохраняет скалярное произведение тогда и только тогда, когда $f$ переводит 
	ортонормированный базис в ортонормированный базис.
\end{theorem}
\begin{proof}
	\textit{Очевидно}.
\end{proof}

\begin{theorem}
	Линейное отображение $\cA \colon X \to Y$, задаваемое в фиксированных 
	ортонормированных базисах $X$ и $Y$ матрицей $A$ сохраняет скалярное произведение 
	тогда и только тогда, когда $A^T A = I$.
\end{theorem}
\begin{proof}
	Нетрудно проверить, что
\[
	(A^T A)_{ij} = \scp{f(\eu_i), f(\eu_j)}
\]
	Откуда, пользуясь предыдущей теоремой, получаем требуемое.	
\end{proof}

\begin{theorem}
	Пусть $T \colon \Rm \to \Rm$ --- ортогональное преобразование. Тогда $T$ 
	сохраняет меру Лебега.	
\end{theorem}
\begin{proof}
	$T$ гладкое, поэтому сохраняет измеримость. Кротме того, $T$ обратимо,
	поэтому сохраняет меру.
	Проверим, что эта мера совпадает с мерой Лебега. Для этого 
	воспользуемся одной из предыдущих теорем: нужно проверить, 
	что новая мера инваниантна
	относительно сдвигов, совпадает с мерой Лебега на каком-нибудь множестве и 
	конечна на ограниченных множествах.
	\begin{itemize}
		\item Инвариантность относительно сдвига:
\[
	\l(T(A + p)) = \l(T(A) + T(p)) = \l(T(A))
\]
	Последний переход --- инвариантность меры Лебега относительно сдвига.
		\item Покажем, что новая мера совпадает с Лебеговской на шаре $B(0, 1)$:
\[
	\l(T(B(0, 1))) = \l(B(x, 1)) = \l(B(0, 1))	
\]
	Первое равенство выплнено потому, что $T$ не изменяет расстояния, поэтому шар переходит в шар такого 
	же радиуса. Второе --- инвариантность меры Лебега относительно сдвига.
		\item Поскольку образ шара --- шар, $T$ переводит ограниченные множества в ограниченные.
	\end{itemize}
\end{proof}

\begin{theorem}(О структуре компактного оператора)
	
	Пусть $V \colon \Rm \to \Rm$ --- линейное преобразование, $\det{V} \neq 0$. Тогда
\begin{itemize}
	\item Существуют ортонормированные базисы $g_i$, $h_i$ и числа
		$s_i$ такие, что
\[
	\forall \ex \in \Rm~ V(\ex) = \sum_{i = 1}^{m}{\left(s_i \scp{\ex, g_i}\right)h_i} 
\]
	\item $|\det{V}| = s_1 \cdot \ldots \cdot s_m$.
\end{itemize}
\end{theorem}
\begin{proof}
	Пусть $W = V^*V$ --- самосопряженный оператор, потому что:
\[
	\scp{\ex, W\ey} = \scp{V\ex, V\ey} = \scp{W\ex, \ey}
\]
	Раз так, все вего собственные числа вещественны и существует ортонормированный базис, состоящий из собственных векторов $g_i$, отвечающих
	собственным числам $c_1, \ldots, c_m$. Покажем, что $c_i > 0$:
\[
	\norm{V g_i}^2 = \scp{V g_i, V g_i} = \scp{W g_i, g_i} = c_i \norm{g_i}^2
\]
	$\ker{V} = 0 \Lra \norm{V g_i} > 0 \Lra c_i > 0$. Раз так, пусть $s_i = \sqrt{c_i}$, 
	$\displaystyle h_i = \frac{1}{s_i}V g_i$. Проверим:
\[
	\scp{h_k, h_i} = \frac{1}{s_k s_i} \scp{V g_k, V g_i} = \frac{1}{s_k, s_i} \scp{W g_k, g_i} 
	= \frac{c_k}{s_k s_i} \scp{g_k, g_i} = \delta_{ki}
\]
	Значит, $h_i$ --- ортонормированный базис. Далее:
\[
	V\ex = \sum_{i = 1}^{m}{V(\scp{\ex, g_i} g_i)} = \sum_{i = 1}^{m}{\scp{\ex, g_i} V(g_i)}
	= \sum_{i = 1}^{m}{s_i \scp{\ex, g_i} g_i}
\]
	Проверим второй пункт теоремы:
\[
	c_1 \cdot \ldots \cdot c_m = \det{W} = \det{V^*V} = (\det{V})^2
\]
\end{proof}

\begin{lemma}(Мера собственного подпространства)
	
	Мера Лебега собственного подпространства равна нулю.
\end{lemma}
\begin{proof}
	Не умаляя общности, можно рассматривать подпространство \\ $\R^{m - 1} \subseteq \Rm$.
	Развернем это подпространство так, чтобы последняя координата его точек занулилась.
	Мера от этого не поменялась (ортогональное преобразование не меняет меру). Получившееся
	множество нетрудно накрыть сколь угодно малой меры параллелепипедами, откуда получаем,
	что $\forall \e > 0~ \l(\R^{m - 1}) < \e$.
\end{proof}

\begin{theorem}
	Пусть $T \colon \Rm \to \Rm$ --- линейное преобразование. Тогда
\[
	\forall A \in \mathfrak{M}^m~ T(A) \in \mathfrak{M}^m,~ \l(T(A)) 
	= |\det{T}|\cdot \l(A)
\]
\end{theorem}
\begin{proof}
	\enewline
	\begin{itemize}
		\item Пусть $T$ вырождено, то есть $\det{T} = 0$. Тогда 
			$\im{T}$, а вместе с ним и любое множество в $\Rm$
			отображается в пространство меньшей размерности. По лемме 
			это означает, что $\forall A \subseteq \Rm~ \l(T(A)) = 0$.
		\item Пусть теперь $\det{T} \neq 0$. Абсолютно аналогично теореме
			об ортогональных преобразованиях доказывается, что 
			$\l(T(A))$ --- мера, инвариантная относительно сдвига. Кроме того,
			образ ограниченного множества под действием $T$ ограничен 
			(ограниченное множество можно вложить в замнкутый шар, 
			который компактен и по непрерывности перейдет в компакт).
			Тогда по теореме о других мерах
\[
	\exists K \in [0, +\infty)\colon~ \l(T(A)) = K \cdot \l(A)
\]
			Все, что осталось --- это понять, почему $K = \det{T}$. Для этого
			воспользуемся леммой о структуре компактного оператора: получим
			$g_i$ и $h_i$. Вычислим $K$ опираясь на то, куда $T$ пересадит 
			параллелепипед, натянутый на векторы $g_i$: $T(g_i) = h_i s_i$, 
			поэтому параллелепипед $G$, натянутый на $g_i$ перейдет в 
			параллелепипед $H$, натянутый на $h_i s_i$:
\[
	\l(T(G)) = \prod{\norm{h_i s_i}} = \prod{s_i} = |\det{T}| = |\det{T}| \cdot \l(G) 
\]
	\end{itemize}
\end{proof}

% preamble change fix
\let\x\undefined
\let\y\undefined
\let\h\undefined
\let\w\undefined
\let\z\undefined
\let\Od\undefined
\let\N\undefined
\let\C\undefined
% /preamble change fix
