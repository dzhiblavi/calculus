\section{Относительный экстремум}

\begin{definition}
    Пусть $f \colon E \subseteq \R^{m + n} \to \R$, $\phi \colon E \to \R^n$,
    $M_{\phi} = \{\,\x \in E \mid \phi(\x) = \elemvec{0}\,\}$, $\x_0 \in E$, $\phi(\x_0) =
    \elemvec{0}$ называется точкой локального \textit{относительного} экстремума, если
    $x_0$ --- точка локального экстремума $f\big|_{M_{\phi}}$.
\end{definition}

\begin{theorem}(Необходимое условие относительного экстремума)

    Пусть $C^1 \ni f \colon E \subseteq \R^{m + n} \to \R$, $C^1 \ni \phi \colon
    E \to \R^n$, $\ea \in E$, $\phi(\ea) = \elemvec{0}$, $\rank{\phi'(\ea)} = n$,
    $\ea$ --- точка локального относительного экстремума, тогда $\exists \lambda \in \Rn
    \colon$
\[
    \begin{cases}
        f'(\ea) - \lambda \cdot \phi'(\ea) = 0 \\
        \phi(\ea) = \elemvec{0}
    \end{cases}
\]
\end{theorem}
\begin{proof}
    Будем обозначать $(\x \in \Rm, \y \in \Rn) \in \R^{m + n}$
    Пусть ранг производного оператора $\phi'(\ea)$ реализуется на
    последних $n$ столбцах. Тогда
\[
    \det{\left( \pderv{\phi_i}{\x_{m + j}}(\ea) \right)}_{\substack{i = 1..n
    \\ j = 1..n}} \neq 0
\]
    Тогда можно применить теорему о неявном отображении:
\[
    \exists U(\ea_x), U(\ea_y)~ \exists C^r \ni \f \colon U(\ea_x) \to U(\ea_y)
    \colon \phi(\x, \f(\x)) = \elemvec{0}
\]
    Рассмотрим функцию $g(\x) = f(\x, \f(\x))$. Тогда $\ea_x = (\ea_1, \ldots, \ea_m)$
    является точкой обычного локального экстремума для функции $g$. Далее будут
    использованы не совсем обычные, но понятные обозначения для частных производных.
    Выпишем необходимое условие экстремума:
\[
    0 = g'(\ea_\x) = f'_{\x}(\ea_x, \f(\ea_x)) + f'_{\y}(\ea_x, \f(\ea_x)) \cdot \f'(\ea_x) =
    \underbrace{f'_{\x}(\ea)}_{1 \times m} + \underbrace{f'_{\y}(\ea)}_{1 \times n}
    \cdot \underbrace{\f'(\ea_x)}_{n \times m}
\]
    Кроме того, нам известно, что $\phi(\x, \f(\x)) = \elemvec{0}$, тогда:
\[
    \underbrace{\phi'_{\x}(\ea)}_{n \times m} + \underbrace{\phi'_{\y}(\ea)}_{n \times n}
    \cdot \underbrace{\f'_{\x}(\ea_x)}_{n \times m} = \elemvec{0} \Lra
    \forall \l \in \Rn~~ \l \cdot \phi'_{\x}(\ea) + \l \cdot \phi'_{\y}(\ea) \cdot
    \f'_{\x}(\ea_x) = 0
\]
    Вычтем из первого равенства второе:
\[
    (f'_{\x} - \l \cdot \phi'_{\x}) + (f'_{\y} - \l \cdot \phi'_{\y}) \f'_{\x} = 0
\]
    и положим
\[
    \l = f'_{\y}(\ea) \cdot (\phi'_{\y}(\ea))^{-1}
\]
    Убедимся в том, что $\l$ подходит:
\begin{align*}
    f'_{\x} - \l \cdot \phi'_{\x} &= f'_{\x} - f'_{\y} \cdot (\phi'_{\y})^{-1}
    \cdot \phi'_{\x} = f'_{\x} - f'_{\y} \cdot (\phi'_{\y})^{-1} \cdot (-\phi'_{\y}
    \cdot \f'_{\x}) = f'_{\x} + f'_{\y} \cdot \f'_{\x} = 0 \\
    f'_{\y} - \l \cdot \phi'_{\y} &= f'_{\y} - f'_{\y} \cdot (\phi'_{\y})^{-1}
    \cdot \phi'_{\y} = 0
\end{align*}
\end{proof}

\begin{definition}
    В терминах последней теоремы отображение
\[
    G = f - \l \phi
\]
    называется \textit{функцией Лагранжа}.
\end{definition}

\begin{theorem}(Достаточное условие относительного экстремума)

    Пусть $C^1 \ni f \colon E \subseteq \R^{m + n} \to \R$, $C^1 \ni \phi \colon
    E \to \R^n$, $\ea \in E$, $\phi(\ea) = 0$, $\rank{\phi'(\ea)} = n$,
    выполнено необходимое условие относительного экстремума, то есть $\exists
    \lambda \in \Rn \colon$
 \[
     \begin{cases}
         f'(\ea) - \lambda \cdot \phi'(\ea) = 0 \\
         \phi(\ea) = 0
     \end{cases}
 \]
    кроме того, пусть $\h = (\h_x \in \Rm, \h_y \in \Rn)$. Тогда, так как
    $\rank{\phi'(\ea)} = n$, то по $\h_x$ можно однозначно восстановить $\h_y$ такой,
    что $\phi'(\ea)\h = 0$. Тогда рассмотрим квадратичную форму
\[
    Q(\h_x) = \d^2_{\ea}{G(\h_x, \h_y)}
\]
    Где $G = f - \lambda \cdot \phi$ --- функция Лагранжа. В зависимости от
    определенности $Q$ можно сделать вывод о наличии экстремума в точке $\ea$:
    \begin{itemize}
        \item $Q$ положительно определена $\Lra \ea$ --- точка относительного
        локального минимума.
        \item $Q$ отрицательно определена $\Lra \ea$ --- точка относительного
        локального максимума.
        \item $Q$ неопределена $\Lra \ea$ --- не точка экстремума.
        \item В остальных случаях требуется более детальное исследование.
    \end{itemize}
\end{theorem}

\begin{lemma}
    Пусть $A$ --- матрица $m \times m$. Тогда
\begin{itemize}
    \item $A^T A$ симметрична
    \item $\scp{A\x, A\x} = \scp{A^T A \x, \x}$
    \item У $A^T A$ все собственные числа неотрицательны.
\end{itemize}
\end{lemma}
\begin{proof}
    \enewline

    \begin{itemize}
        \item Помним, что $(A^T)^T = A$ и $(AB)^T = B^T A^T$
\[
    (A^T A)^T = A^T (A^T)^T = A^T A
\]
        \item
\begin{align*}
    \scp{A \x, A \x} &= \sum_{i = 1}^{m}{(A\x)_i^2}
    = \sum_{i = 1}^{m}{\left(\sum_{j = 1}^{m}{a_{ij} \x_j}\right)^2}
    = \sum_{i = 1}^{m}{\left(\sum_{j = 1}^{m}{a_{ij} \x_j} \right)
    \cdot \left(\sum_{k = 1}^{m}{a_{ik} \x_k}\right)} \\
    &= \sum_{i = 1}^{m}{\sum_{j = 1}^{m}{\left(\sum_{k = 1}^{m}{a_{ij} a_{ik} \x_k}
    \right) \x_j}} = \sum_{i = 1}^{m}{\sum_{j = 1}^{m}{(A^T A \x)_j} \x_j} \\
    &= \scp{A^T A \x, \x}
\end{align*}
        \item
\begin{align*}
    \l \norm{\x}^2 = \scp{\l \x, \x} = \scp{A^T A \x, \x} =
    \scp{A\x, A\x} = \norm{A\x}^2 \geqslant 0
\end{align*}
    \end{itemize}
\end{proof}

\begin{theorem}(Вычисление нормы линейного оператора)

    Пусть $A \in Lin(\Rm, \Rn)$, $S$ --- множество собственных чисел $A^T A$.
    Тогда
\[
    \norm{A} = \max_{\lambda \in S}{\sqrt{\lambda}}
\]
\end{theorem}
\begin{proof}
    \enewline

    \begin{itemize}
    \item
    Вычислим для начала максимум $f(\x) = \scp{A\x, \x} \colon \Rm \to \R$ на сфере
    $\x_1^2 + \ldots + \x_m^2 = 1$, где $A$ --- симметричная матрица.
\[
    \begin{cases}
        f(\x) = \sum{a_{ij} \x_i \x_j} \\
        \x_1^2 + \ldots + \x_m^2 - 1 = 0
    \end{cases}
\]
    Тогда функция Лагранжа имеет вид
\[
    G = \sum{a_{ij} \x_i \x_j} - \l \cdot \left( \sum_{i}{\x_i^2} - 1 \right)
\]
    Продифференцируем её:
\[
    G'_{\x_k} = 2 \sum{a_{kj} \x_j} - 2 \l \x_k
\]
    Здесь мы воспользовались симметричностью матрицы. Решим систему уравнений
    $G' = \elemvec{0}$:
\[
    \begin{cases}
        A \x - \l \x = 0 \\
        \x_1^2 + \ldots + \x_m^2 = 1
    \end{cases}
\]
    Решениями этой системы могут быть пары из собственных векторов $\x$
    и собственных чисел $\l$ (причем все собственные числа попадут в пару).
    Вычислим $f$ в собственных векторах матрицы $A$.
\[
    f(\x) = \scp{A \x, \x} = \scp{\l \x, \x} = \l \norm{\x} = \l
\]
    \item Докажем утверждение теоремы.
\[
    \norm{A}^2 = \max_{\x \in S^{m - 1}}{\norm{A \x}^2}
    = \max_{\x \in S^{m - 1}}{\scp{A \x, A \x}} = \max_{x \in S^{m - 1}}
    {\scp{(A^T A) \x, \x}} = \max_{\l \in \sigma{A^T A}}{\l}
\]
    По предыдущей лемме $A^T A$ симмметрична, тогда:
\[
    \max_{x \in S^{m - 1}} {\scp{A^T A \x, \x}} = \max_{\l \in \sigma{A^T A}}{\l}
\]
    Но тогда, так как $\l \geqslant 0$, имеем:
\[
    \norm{A} = \max_{\l \in \sigma{A^T A}}{\sqrt{\l}}
\]
    \end{itemize}
\end{proof}
